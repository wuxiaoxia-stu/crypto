# -*- coding: utf-8 -*-
from netcacrypto import SignedData
import base64
import os, re
import time
import string
#import objgraph

def signedData():
        signedData_base64="MIIN3wYJKoZIhvcNAQcCoIIN0DCCDcwCAQExDTALBglghkgBZQMEAgEwggZ/BgkqhkiG9w0BBwGgggZwBIIGbHsicmVxTnVtIjoiMTYwODAyMjY0MDAwMF9NeXNkZjgyZSIsImtleUJpdHMiOjIwNDgsInNtMiI6dHJ1ZSwia2V5SW5kZXgiOiJkNGRmMTIyZTdhMGE0ZDEwYTA5OThmZWViYzNiNDJiNyIsImNlcnRDb250ZW50IjoiTUlJRUhEQ0NBOE9nQXdJQkFnSUxFTTJ4NW5zQmNxN0cvSVV3Q2dZSUtvRWN6MVVCZzNVd1lqRUxNQWtHQTFVRUJoTUNRMDR4SkRBaUJnTlZCQW9NRzA1RlZFTkJJRU5sY25ScFptbGpZWFJsSUVGMWRHaHZjbWwwZVRFdE1Dc0dBMVVFQXd3a1RrVlVRMEVnVTAweUlGUkZVMVF3TVNCaGJtUWdSWFpoYkhWaGRHbHZiaUJEUVRBeE1CNFhEVEl3TVRJeE5UQTNNalF6TmxvWERUSXdNVEl4TnpBM05USXdNRm93Z2VreERqQU1CZ05WQkFjTUJXZDZNakl5TVFzd0NRWURWUVFHRXdKRFRqRVNNQkFHQTFVRUNBd0pSM1ZoYm1ka2IyNW5NVm93V0FZRFZRUUtERkhtbDZEbGhiUG9nWlRsbTU3bHZaTG1uTHJtbm9UbXRZdm9yNVZVZFdVZ1JHVmpJREUxSURJd01qQWdNVFU2TWpVNk1EY2dSMDFVS3pBNE1EQWdLT1M0cmVXYnZlYWdoK1dIaHVhWHR1bVh0Q2t4V2pCWUJnTlZCQU1NVWVhWG9PV0ZzK2lCbE9XYm51VzlrdWFjdXVhZWhPYTFpK2l2bFZSMVpTQkVaV01nTVRVZ01qQXlNQ0F4TlRveU5Ub3dOeUJIVFZRck1EZ3dNQ0FvNUxpdDVadTk1cUNINVllRzVwZTI2WmUwS1RCWk1CTUdCeXFHU000OUFnRUdDQ3FCSE05VkFZSXRBMElBQkIyRnd4MElydUhIeGJtYnhjSXNrNGU5aFFNVjBjSDhKemMvSnJGd09TWUtBaU1Ic2wvSmVLK2VRdGw0NlVmSnQvUmptY0tFTlRLU3FuRzRVa2w1bW5DamdnSFdNSUlCMGpBTUJnTlZIUk1CQWY4RUFqQUFNQjBHQTFVZERnUVdCQlFKSDE4ZXpqWm5pcE9NcWFaYktteTZFcUVrd2pBZkJnTlZIU01FR0RBV2dCUU1lK3RpY3dOMStveEtKQXoyanpzaFpYNFg2VEJyQmdOVkhTQUVaREJpTUdBR0Npc0dBUVFCZ1pKSURRb3dVakJRQmdnckJnRUZCUWNDQVJaRWFIUjBjRG92TDNkM2R5NWpibU5oTG01bGRDOWpjeTlyYm05M2JHVmtaMlV2ZDJocGRHVndZWEJsY2k5amNITXZibVYwUTBGMFpYTjBZMlZ5ZEdOd2N5NXdaR1l3TXdZRFZSMGZCQ3d3S2pBb29DYWdKSVlpYUhSMGNEb3ZMM1JsYzNRdVkyNWpZUzV1WlhRdlkzSnNMMU5OTWtOQkxtTnliREFPQmdOVkhROEJBZjhFQkFNQ0JzQXdOQVlLS3dZQkJBR0Jra2dCRGdRbURDUTFaV1UzTlRnME1UaGtPRGd3TkdKaE1XRTFNVEUyWW1FeE16bGtOekUzTUVCVE1ESXdGUVlNS3dZQkJBR0Jra2dCREF3Q0JBVU1BekF3TVRCb0Jnb3JCZ0VFQVlHU1NBRVBCRm93V0RBV0FnSUNBQUlCQVFRTk1UWXdPREF4TnpFd056QXdNREFmQWdJQ0FBSUJBZ1FXVFZSWmQwOUVRWGhPZWtWM1RucEJkMDFCUFQwTkNqQWRBZ0lDQUFJQkZBUVVxKzRmelYvWG8zT2ZjVU5vMEg3bmEySlR0Q0V3R1FZSkt3WUJCQUdCa2tnUUJBd0dDaXNHQVFRQmdaSklFQW93Q2dZSUtvRWN6MVVCZzNVRFJ3QXdSQUlnTTdGQlUyZG9FRWZMdlN6dm9UeThPSzFGcFhEbWk5c0J6N2FpNEkvY0tZRUNJQ1FiaGNacHFOWTRUd0hTQk8xZGZKTW8rZkdaeWZ0aSthZDZacVlzVVRWciIsInN1YmplY3RETiI6eyJjbiI6InlnIiwibyI6Im5ldGNhIiwib3UiOiJjc2JtIiwiYyI6IkNOIiwibCI6ImdkZ3oiLCJlbWFpbCI6InllcWl1anVAY25jYS5uZXQiLCJzdCI6Imd1YW5nZG9uZyJ9faCCBSswggUnMIIED6ADAgECAgsQhHsaOKd7xcETfzANBgkqhkiG9w0BAQsFADBSMQswCQYDVQQGEwJDTjEkMCIGA1UECgwbTkVUQ0EgQ2VydGlmaWNhdGUgQXV0aG9yaXR5MR0wGwYDVQQDDBRDQ1MgTkVUQ0EgVDIgU3ViMSBDQTAeFw0yMDEyMDEwNjMzMTJaFw0yMTAxMjcwNjIxMjRaMEQxDzANBgNVBAcMBuW5v+W3njELMAkGA1UEBhMCQ04xEjAQBgNVBAgMCUd1YW5nZG9uZzEQMA4GA1UEAwwHcWoxMTI2MTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALRibahA+YsD/5JFxVGeo/eBN2yRvnh5vm29bfFDAXXLS/ZN9QgHtH71uQQtpBGoYqNWP0/FTLOZ0Wy0XrS3Xc1mXIiKIhE168ztDTLmrSqIVsZ4ZQBQ2e1v9yMIuvcArxckM10eIwKEQZ0YWIOkHzBlqhSSSlsPRcuKRrfUzu67nO9GgukLEDgAc0sufEdHa2nkPLA2zsAZuVLRdOSFSEQw8vYMCkHZmNceTtNjDvAneg9F28s2p4U4JSH55+evkM20LPlxkoLzes2+X0DX4UjqjEKLbIVGCuZH1Y6xBikZ05OIUYd5ATFyHgZsUIUV8AuIZhSleX0J1kzsXjvm5EkCAwEAAaOCAgowggIGMB8GA1UdIwQYMBaAFAa5H9WdsgzxxIR0QsIwJeIJ2lbYMB0GA1UdDgQWBBQ7o+ojvUnrB6gm+65Ifz/UBZhN/DBsBgNVHSAEZTBjMGEGCysGAQQBgZJIAgoBMFIwUAYIKwYBBQUHAgEWRGh0dHA6Ly93d3cuY25jYS5uZXQvY3Mva25vd2xlZGdlL3doaXRlcGFwZXIvY3BzL25ldENBdGVzdGNlcnRjcHMucGRmMDsGA1UdHwQ0MDIwMKAuoCyGKmh0dHA6Ly90ZXN0LmNuY2EubmV0L2NybC9ORVRDQVQxU3ViMUNBLmNybDAMBgNVHRMBAf8EAjAAMDQGCisGAQQBgZJIAQ4EJgwkMGYwNmIzNjNkZmRkNjhhNGEyOWM2MjIyZTMwNTM0MDhATDM1MIHEBggrBgEFBQcBAQSBtzCBtDA7BggrBgEFBQcwAYYvaHR0cDovLzE0LjE4LjE1OC4xNDc6NjE4MC9vY3NwY29uc29sZS9jaGVjay5kbyAwNAYIKwYBBQUHMAGGKGh0dHA6Ly8xOTIuMTY4LjAuNjEvb2NzcGNvbnNvbGUvY2hlY2suZG8wPwYIKwYBBQUHMAGGM2h0dHA6Ly9vY3NwdGVzdC5jbmNhLm5ldDo2MTgwL29jc3Bjb25zb2xlL2NoZWNrLmRvIDAOBgNVHQ8BAf8EBAMCB4AwDQYJKoZIhvcNAQELBQADggEBAJO4E2/llk8BJE11gPJ8KPMKT3MiTrCJcuO++NRfPWnWU/azF6j+sGy+7kizM4XI59qevQfu6Nm6jX6B/Zs1yxBjzvaq3YsnNA1jlOxtT4+UYLt3R79RJ3jdX+DjgCDlnuG+MEWgt5Pvf7f154SRPFRsTils4pbj1f2xMbg5PVwl66Gasz9X1LxQ1n77tgBdbCJXHfAOIBWasZV5WoWbQt57MUqmIhITs2gvdeUYF8axR3XizpKskWTkX816f/u0P0l+VuIAlNR8CZmrD5g3DkQuL3rR5iK1e/p+kLdzQ0wZTOOei2/re8FMaWyXDKL9AVx16wieyPN3toFrLyIfO/QxggIEMIICAAIBATBhMFIxCzAJBgNVBAYTAkNOMSQwIgYDVQQKDBtORVRDQSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxHTAbBgNVBAMMFENDUyBORVRDQSBUMiBTdWIxIENBAgsQhHsaOKd7xcETfzALBglghkgBZQMEAgGgejAPBgkqhkiG9y8BAQgxAjAAMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTIwMTIxNTA4NTcwOFowLwYJKoZIhvcNAQkEMSIEIGWtWuQSM+eCQZ/MnvpRL79CwZE2pbXZBwQbF+DxFD4+MAsGCSqGSIb3DQEBCwSCAQBdp2p3GehkY8Z1SVDNrJRKFmLltOcrNd1d9YYUtrCx4JwnNhxSOzwq1ECG7BVH0aFtd2FlNpX71sR2EjrfDzajdwZLQ5Ltb4MmIboNmoydKmC46CJOQtOtgr1y0Qv/i2YVN9Wsfa8ea18hSWztK+Lg3GxXy5bj7gyK7hPzGSRm/ndOSoiQDVkhnsQ3E2dxQOz9EhzwoNQ/lY4XM5EUC6gI6ZzJ18Y0CGGLSK1YlPQ/NWz2Z0C594EBTz3eASd+2sC1QJm8VN3m8voUF6anmJjlbz91yXu5yiG95Qf80QcDJtvwFqt/be0HRHp1Dpk3PhuuPs1kk+2DsvbhxJFPXuyD9793280="

        sign_data=base64.b64decode(signedData_base64)
        with SignedData.new_verify_object() as signedData:
                subject=signedData.verify_onestep(sign_data)
                print("sign cert subject:\t"+subject)
		

if __name__ == '__main__':
	signedData()

